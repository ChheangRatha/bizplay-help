# Agent

\[개요\]  
 - ERP사에서 생성한 Temp 테이블에 bizplay에서 제공하는 경비관리 데이터를 저장합니다.

![{&#xADF8;&#xB9BC;1} &#xC5D0;&#xC774;&#xC804;&#xD2B8; &#xAD6C;&#xC131;&#xB3C4;](../../.gitbook/assets/image%20%28156%29.png)

   ① ERP시스템에 설치한 연계 Agent데몬이 설정한 시간에 작업을 시작 합니다.  
   ② bizplay OPEN API 호출 하여 응답 받습니다.  
   ③ ERP사에서 생성한 Temp테이블에 데이터를 저장 합니다.

      `※ 고객사 DBMS는 Oracle, MS-Sql, DB2, 파일DB 등 가능 합니다.  
 ※ ③번 DB 저장 외 SAP RFC방식, FTP(파일전송) 등 가능 합니다.  
 ※ Temp Table에서 내부에 활용하는 업무는 고객 또는 ERP업체가 작업 해야 합니다.`

\`\`

\[방화벽 설정\]  
 - bizplay는 OPEN API 로 연결 되어 아래와 같은 Out-Bound 방화벽 설정이 필요 합니다.  
  \(In-bound 없음\)

![\[&#xADF8;&#xB9BC;2\] &#xBC29;&#xD654;&#xBCBD; &#xC124;&#xC815;](../../.gitbook/assets/image%20%28108%29.png)

   ① bizplay는 목동 KT IDC센터에 금융 클라우드 센터로 운영 합니다.  
   ② 도착지 호출은 URL 방식으로 내부 서버에서 DNS를 찾을 수 없으면 HOSTS파일에 등록해야  
    합니다.  
   ③ 개발 API 전문테스트는 개발 작업 시 에만 필요 합니다.  
   ④ 이미지 링크는 ERP나 GW에서 첨부 이미지 링크가 필요할 경우 사용 합니다.

\[DB접속정보\]  
 - 생성된 DB Temp 테이블 접속 할 수 있는 계정과 암호를 제공하여 주어야 합니다.

\[에이전트 설치 사양\]  
 - H/W, O/S 설치 사양 입니다.

![\[&#xADF8;&#xB9BC;3\] H/W, O/S &#xC0AC;&#xC591;](../../.gitbook/assets/image%20%2814%29.png)

   `※ MS 서버만 설치 가능합니다.  
※ Oracle, MS-Sql, DB2, 파일DB 등 접근 가능합니다.`

\[에이전트 사용법\]  
 **- 에이전트\(쿠콘박스2.0\) 설치 방법입니다.**

![\[&#xADF8;&#xB9BC;4\] &#xC5D0;&#xC774;&#xC804;&#xD2B8; &#xC124;&#xCE58;](../../.gitbook/assets/image%20%28239%29.png)

   ① CooconBox2.0법인카드.exe 설치 파일을 실행 후 다음을 클릭합니다.  
   ② 설치경로 를 선택 후 다음을 클릭합니다.  
   ③ 시작 메뉴에 프로그램을 등록합니다.  
   ④ 바로가기 아이콘을 만듭니다.  
   ⑤ 프로그램을 설치를 시작합니다.  
   ⑥ CooconBox 설치가 완료 되었습니다.

 **- 에이전트 "환경설정" 방법입니다.**

![\[&#xADF8;&#xB9BC;5\] &#xD658;&#xACBD;&#xC124;&#xC815;](../../.gitbook/assets/image%20%28150%29.png)

   ① 설치된 경로에서 Coocon\_Config.exe 를 실행합니다.  
   ② "환경설정" 탭에서 "디비접속정보" "찾기"를 클릭합니다.  
   ③ 데이터 연결 속성 팝업창에서 연결할 데이터를 선택합니다.

![\[&#xADF8;&#xB9BC;6\] DB &#xC5F0;&#xACB0;](../../.gitbook/assets/image%20%28210%29.png)

   ④ 1. 서버 이름을 선택하거나 입력을 합니다.  
        2. 서버에 로그온할 때 사용할 정보를 입력합니다.  
           - "암호 저장 허용\(S\)" 체크  
        3. 서버에서 데이터베이스를 선택합니다.  
          - "연결 테스트\(T\)" 클릭 합니다.  
   ⑤ 데이터 연결 성공여부를 확인합니다.  
   ⑥ "테이블 생성"에서 DB 선택 후 "생성"을 클릭합니다.  
        - "저장"을 클릭 합니다. 

![\[&#xADF8;&#xB9BC;7\] &#xD14C;&#xC774;&#xBE14; &#xC0DD;&#xC131;](../../.gitbook/assets/image%20%28149%29.png)

 **- 에이전트 "서비스 인증요청" 방법입니다.**

![\[&#xADF8;&#xB9BC;8\] &#xC11C;&#xBE44;&#xC2A4; &#xC778;&#xC99D;&#xC694;&#xCCAD;](../../.gitbook/assets/image%20%2863%29.png)

   ① 기관코드, 사업자 번호, 사업장 명, 서비스 명, 담당자 명, 담당자 연락처, 담당자 이메일, 운영IP   
       입력 후   "조회"를 클릭 합니다. \(고객사 담당자 명 입력\)  
   ② "출력"부분에 결과코드, 결과메세지, API KEY 출력되면 결과메세지 확인 후 "저장"을 클릭합니다.  
   ③ "찾기" 클릭하면 "사업장 조회" 팝업창이 뜨며 저장한 정보를 확인 할 수 있습니다.

 **- 에이전트 "업무설정" 방법입니다.**

![\[&#xADF8;&#xB9BC;9\] &#xC5C5;&#xBB34;&#xC124;&#xC815;](../../.gitbook/assets/image%20%2864%29.png)

   ① 탭 "카드"  bizplay 데이터전송을 설정하는 화면입니다.  
   ② 탭 "원본카드" 카드사 원본 데이터전송을 설정하는 화면입니다.   
   ③ 탭"기타" 모바일 메세지 전송, i-Cube 회계전표, 지출결의 사용유무 설정하는 화면입니다.  
      `※ 모바일 메세지 전송  
  - 모바일 메세지 전송을 하기 위해서는 그린메시지 설치가 필요 합니다.  
  - 에이전트 설치된 폴더 "Conf.ini" 파일안에 "#그린메세지 interval : 분단위" 설정을 합니다.  
  - 테이블 "MSG_LNK_LIS" 데이터를 넣어 메세지 전송을 합니다.`

![\[&#xADF8;&#xB9BC;10\] &#xC218;&#xAE30;&#xC870;&#xD68C;](../../.gitbook/assets/image%20%2823%29.png)

   ④ 승인내역 수기조회시 "사용" 체크, "기간설정"\(최대 2개월\) 후 "수기조회" 클릭 합니다.   
   ⑤ "팝업창" 뜨면서 승인내역 데이터를 가져옵니다.  
   ⑥ 설정을 마친 후 "저장"을 클릭합니다.

 **- 에이전트 "스케줄설정" 방법입니다.**

![\[&#xADF8;&#xB9BC;11\] &#xC2A4;&#xCF00;&#xC904; &#xC124;&#xC815;](../../.gitbook/assets/image%20%28117%29.png)

   ① "카드" 탭을 클릭합니다. \(고객사 사용 서비스 선택\)  
   ② "카드목록조회" "월~일"요일까지 선택가능하고 선택시간에 1번 자동으로 조회합니다.  
   ③ "승인내역조회" 탭을 클릭합니다.  
   ④ "월~일"요일 선택합니다.  
   ⑤ "시", "분" 선택 후 "추가"를 클릭하면 목록에 시간이 추가됩니다.  
        목록에 시간 선택 후 "제거"를 클릭하면 삭제가 됩니다.  
   ⑥"이전일 부터 조회"  설정된 이전날짜부터 당일까지 데이터를 조회합니다.  
   ⑦ 설정이 끝나면 "저장"을 클릭합니다.

 **- 에이전트 "서비스 관리" 방법입니다.**

![\[&#xADF8;&#xB9BC;12\] &#xC11C;&#xBE44;&#xC2A4; &#xAD00;&#xB9AC;](../../.gitbook/assets/image%20%28127%29.png)

   ① "서비스 등록"에서 "등록"버튼을 클릭 합니다.  
         - COOCON\_BOX2.exe 서비스에 등록을 시킴  
        "서비스 시작"에서 "시작"버튼을 클릭 합니다.  
         - COOCON\_BOX.exe, Coocon\_Router.exe 실행이 됩니다.  
   ② "서비스 시작"에서 "종료"클릭시 서비스가 종료됩니다.  
        "서비스 등록"에서 "제거"클릭시 서비스가 제거됩니다.  
   ③ "작업관리자" 프로세스 실행되는 화면입니다.

 **- 에이전트 "DB쿼리" 방법입니다.**

![\[&#xADF8;&#xB9BC;13\] DB&#xCFFC;&#xB9AC; &#xAD00;&#xB9AC;](../../.gitbook/assets/image%20%2898%29.png)

   ① 리스트박스 클릭 후 목록을 선택합니다.  
   ② 조회된 DB쿼리문을 수정합니다.  
   ③ "수정"버튼을 클릭합니다.

